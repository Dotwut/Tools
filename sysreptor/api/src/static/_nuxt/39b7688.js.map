{"version":3,"sources":["webpack:///./components/LoginOidcForm.vue","webpack:///./components/LoginOidcForm.vue?bcd6","webpack:///./components/LoginOidcForm.vue?7522","webpack:///./pages/login/reauth.vue?71c7","webpack:///./pages/login/reauth.vue","webpack:///./pages/login/reauth.vue?e642","webpack:///./utils/urls.js"],"names":["auth","computed","authProviders","this","$store","getters","auth_providers","mounted","length","$router","replace","methods","authProviderLoginBegin","authProvider","options","reauth","url","URL","absoluteApiUrl","id","$axios","window","location","searchParams","append","assign","href","component","_v","key","on","preventDefault","_vm","attrs","_t","staticRenderFns","installComponents","SBtn","default","SCard","head","title","$auth","user","can_login_local","can_login_oidc","$refs","loginOidcForm","onLogin","redirect","fn","proxy","_c","ref","scopedSlots","LoginForm","LoginOidcForm","i","axios","some","p","startsWith","urlJoin","defaults","baseURL","origin","CursorPaginationFetcher","toast","nextPageURL","isLoading","data","hasError","errorData","hasNextPage","$get","res","next","push","results","response","global","requestError","error","SearchableCursorPaginationFetcher","searchFilters","search","_searchFilters","_fetchNextPageDebounced","debounce","_fetchNextPage","fetcher","_createFetcher","URLSearchParams","split","Object","entries","k","v","Array","isArray","delete","e","set","searchUrl","toString","val","fetchNextPage","filters","fetchNextPageImmediate","flush"],"mappings":"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","file":"39b7688.js","sourcesContent":["\nimport { absoluteApiUrl } from '~/utils/urls';\n\nexport default {\n  auth: false,\n  computed: {\n    authProviders() {\n      return this.$store.getters['apisettings/settings'].auth_providers;\n    }\n  },\n  mounted() {\n    if (this.authProviders.length === 0) {\n      this.$router.replace('/login/local/');\n    }\n  },\n  methods: {\n    authProviderLoginBegin(authProvider, options = { reauth: false }) {\n      const url = new URL(absoluteApiUrl(`/auth/login/oidc/${authProvider.id}/begin/`, this.$axios), window.location);\n      if (options.reauth) {\n        url.searchParams.append('reauth', 'true');\n      }\n      window.location.assign(url.href);\n    }\n  }\n}\n","import mod from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./LoginOidcForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/babel-loader/lib/index.js??ref--2-0!../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./LoginOidcForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LoginOidcForm.vue?vue&type=template&id=1e9af66c&\"\nimport script from \"./LoginOidcForm.vue?vue&type=script&lang=js&\"\nexport * from \"./LoginOidcForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* nuxt-component-imports */\ninstallComponents(component, {SBtn: require('/app/frontend/components/S/Btn.vue').default,SCard: require('/app/frontend/components/S/Card.vue').default})\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./reauth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--2-0!../../node_modules/@nuxt/components/dist/loader.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./reauth.vue?vue&type=script&lang=js&\"","\nexport default {\n  head: {\n    title: 'Re-Authenticate',\n  },\n  mounted() {\n    const authProviders = this.$store.getters['apisettings/settings'].auth_providers;\n    if (!this.$auth.user.can_login_local && this.$auth.user.can_login_oidc && authProviders.length === 1) {\n      this.$refs.loginOidcForm.authProviderLoginBegin(authProviders[0], { reauth: true });\n    }\n  },\n  methods: {\n    onLogin() {\n      this.$auth.redirect('home');\n    },\n  }\n}\n","import { render, staticRenderFns } from \"./reauth.vue?vue&type=template&id=60fd5980&\"\nimport script from \"./reauth.vue?vue&type=script&lang=js&\"\nexport * from \"./reauth.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* nuxt-component-imports */\ninstallComponents(component, {LoginForm: require('/app/frontend/components/LoginForm.vue').default,LoginOidcForm: require('/app/frontend/components/LoginOidcForm.vue').default})\n","import urlJoin from 'url-join';\nimport { debounce } from 'lodash';\n\nexport function absoluteApiUrl(url, axios) {\n  if (['http', 'data'].some(p => url.startsWith(p))) {\n    return url;\n  } else if (url.startsWith('/api/')) {\n    return urlJoin(new URL(axios.defaults.baseURL, window.location).origin, url);\n  } else {\n    return urlJoin(axios.defaults.baseURL, url);\n  }\n}\n\nexport function relativeTo(url, baseUrl) {\n  const absUrl = absoluteApiUrl(url);\n  baseUrl = absoluteApiUrl(baseUrl);\n\n  if (absUrl.startsWith(baseUrl)) {\n    return absUrl.substring(baseUrl.length);\n  } else {\n    return url;\n  }\n}\n\nexport class CursorPaginationFetcher {\n  constructor(baseURL, axios, toast) {\n    this.axios = axios;\n    this.toast = toast;\n    this.baseURL = baseURL;\n\n    this.nextPageURL = this.baseURL;\n    this.isLoading = false;\n    this.data = [];\n    this.hasError = false;\n    this.errorData = null;\n  }\n\n  get hasNextPage() {\n    return this.nextPageURL !== null;\n  }\n\n  async fetchNextPage() {\n    if (!this || this.isLoading || !this.hasNextPage) {\n      return;\n    }\n\n    try {\n      this.isLoading = true;\n\n      const res = await this.axios.$get(this.nextPageURL);\n      this.nextPageURL = res.next;\n      this.data.push(...res.results);\n\n      this.hasError = false;\n      this.errorData = null;\n    } catch (error) {\n      this.hasError = true;\n      this.errorData = error?.response?.data || null;\n\n      this.toast.global.requestError({ error });\n    } finally {\n      this.isLoading = false;\n    }\n  }\n}\n\nexport class SearchableCursorPaginationFetcher {\n  constructor({ baseURL, searchFilters = { search: '' }, axios, toast }) {\n    this.axios = axios;\n    this.toast = toast;\n    this.baseURL = baseURL;\n    this._searchFilters = searchFilters;\n\n    this._fetchNextPageDebounced = debounce(function() { this._fetchNextPage(); }, 500);\n\n    this.fetcher = null;\n    this._createFetcher();\n  }\n\n  _createFetcher() {\n    const searchParams = new URLSearchParams(this.baseURL.split('?')[1]);\n    for (const [k, v] of Object.entries(this.searchFilters)) {\n      if (v) {\n        if (Array.isArray(v)) {\n          searchParams.delete(k);\n          for (const e of v) {\n            searchParams.append(k, e);\n          }\n        } else {\n          searchParams.set(k, v);\n        }\n      }\n    }\n    const searchUrl = this.baseURL.split('?')[0] + '?' + searchParams.toString();\n    this.fetcher = new CursorPaginationFetcher(searchUrl, this.axios, this.toast);\n  }\n\n  search(val) {\n    this._searchFilters = Object.assign(this._searchFilters, { search: val })\n    this._createFetcher();\n    this.fetchNextPage();\n  }\n\n  applyFilters(filters) {\n    Object.assign(this._searchFilters, filters);\n    this._createFetcher();\n    this.fetchNextPageImmediate()\n  }\n\n  get searchFilters() {\n    return this._searchFilters;\n  }\n\n  get searchQuery() {\n    return this.searchFilters.search;\n  }\n\n  set searchQuery(val) {\n    this.search(val, this._searchFilters);\n  }\n\n  get hasNextPage() {\n    return this.fetcher.hasNextPage;\n  }\n\n  get hasError() {\n    return this.fetcher.hasError;\n  }\n\n  get errorData() {\n    return this.fetcher.errorData;\n  }\n\n  get data() {\n    return this.fetcher.data;\n  }\n\n  fetchNextPage() {\n    this._fetchNextPageDebounced();\n  }\n\n  async _fetchNextPage() {\n    await this.fetcher.fetchNextPage();\n  }\n\n  fetchNextPageImmediate() {\n    if (!this) {\n      return;\n    }\n\n    this._fetchNextPageDebounced();\n    this._fetchNextPageDebounced.flush();\n  }\n}\n"],"sourceRoot":""}