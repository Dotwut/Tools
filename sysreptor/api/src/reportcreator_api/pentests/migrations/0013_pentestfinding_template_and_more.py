# Generated by Django 4.0.7 on 2022-09-20 09:55

from django.db import migrations, models
import django.db.models.deletion


def rename_risklevel_none_to_info(apps, schema_editor):
    PentestFinding = apps.get_model('pentests', 'PentestFinding')
    FindingTemplate = apps.get_model('pentests', 'FindingTemplate')

    PentestFinding.objects \
        .filter(risk_level='none') \
        .update(risk_level='info')
    FindingTemplate.objects \
        .filter(risk_level='none') \
        .update(risk_level='info')


class Migration(migrations.Migration):

    dependencies = [
        ('pentests', '0012_pentestfinding_assignee_reportsection_assignee'),
    ]

    operations = [
        migrations.AddField(
            model_name='pentestfinding',
            name='template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='pentests.findingtemplate'),
        ),
        migrations.AlterField(
            model_name='findingtemplate',
            name='risk_level',
            field=models.CharField(choices=[('info', 'Info'), ('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], db_index=True, default='info', max_length=10),
        ),
        migrations.AlterField(
            model_name='pentestfinding',
            name='report',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='findings', to='pentests.pentestreport'),
        ),
        migrations.AlterField(
            model_name='pentestfinding',
            name='risk_level',
            field=models.CharField(choices=[('info', 'Info'), ('low', 'Low'), ('medium', 'Medium'), ('high', 'High'), ('critical', 'Critical')], db_index=True, default='info', max_length=10),
        ),
        migrations.AlterField(
            model_name='reportsection',
            name='report',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='sections', to='pentests.pentestreport'),
        ),
        migrations.RunPython(code=rename_risklevel_none_to_info),
    ]
