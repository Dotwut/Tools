# Generated by Django 4.0.7 on 2022-10-13 08:10

import uuid
from django.conf import settings
import django.contrib.postgres.fields
from django.db import migrations, models
import reportcreator_api.utils.models


def migrate_set_finding_ids(apps, schema_editor):
    PentestFinding = apps.get_model('pentests', 'PentestFinding')
    PentestFinding.objects.update(finding_id=models.F('id'))


class Migration(migrations.Migration):

    dependencies = [
        ('pentests', '0015_alter_findingtemplate_cvss_alter_pentestfinding_cvss'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AlterModelOptions(
            name='pentestreport',
            options={},
        ),
        migrations.AddField(
            model_name='pentestproject',
            name='imported_pentesters',
            field=django.contrib.postgres.fields.ArrayField(base_field=models.JSONField(encoder=django.core.serializers.json.DjangoJSONEncoder), default=list, size=None),
        ),
        migrations.AlterField(
            model_name='findingtemplate',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='lockinfo',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='pentestfinding',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='pentestproject',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='pentestreport',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='projecttype',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='reportsection',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='uploadedasset',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AlterField(
            model_name='uploadedimage',
            name='created',
            field=models.DateTimeField(default=reportcreator_api.utils.models.now, editable=False),
        ),
        migrations.AddField(
            model_name='findingtemplate',
            name='imported',
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AddField(
            model_name='pentestproject',
            name='imported',
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AddField(
            model_name='projecttype',
            name='imported',
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AlterField(
            model_name='pentestproject',
            name='pentesters',
            field=models.ManyToManyField(related_name='projects', to=settings.AUTH_USER_MODEL),
        ),
        migrations.AddField(
            model_name='projecttype',
            name='hidden',
            field=models.BooleanField(db_index=True, default=False),
        ),
        migrations.AddField(
            model_name='pentestfinding',
            name='finding_id',
            field=models.UUIDField(db_index=True, default=uuid.uuid4, editable=False),
        ),
        migrations.AlterField(
            model_name='reportsection',
            name='section_id',
            field=models.CharField(db_index=True, editable=False, max_length=255),
        ),
        migrations.RunPython(code=migrate_set_finding_ids),
        migrations.AlterUniqueTogether(
            name='pentestfinding',
            unique_together={('report', 'finding_id')},
        ),
    ]
